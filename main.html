<!-- 1、音乐播放功能
页面加载时，自动从指定的音乐文件夹（例如music文件夹）中读取所有音乐文件（支持常见音乐格式如.mp3），并在页面上以列表形式展示音乐名称和封面图片（若有）。音乐封面图片需与音乐文件同名且位于images文件夹下（例如音乐文件song1.mp3
对应的封面图片为song1.jpg）。
提供播放、暂停、上一首、下一首、音量调节（包括静音）等基本播放控制功能。播放时需显示当前播放音乐的进度条（可拖动以改变播放位置）和已播放时间 / 总时长信息。
当音乐播放完成后，自动切换到下一首音乐继续播放。
2、音乐搜索功能
在页面顶部设置一个搜索框，用户可以输入关键字对音乐列表进行搜索。搜索结果实时更新在音乐列表中，只显示匹配关键字的音乐。
3、播放列表管理功能
允许用户创建、编辑和删除自定义播放列表。用户可以将音乐从主音乐列表添加到自定义播放列表中，也可以在自定义播放列表内调整音乐的播放顺序（通过拖放操作）。
每个自定义播放列表需有独立的名称，且在页面上有相应的展示区域，显示该播放列表包含的音乐数量和名称列表。用户可以点击切换到不同的播放列表进行播放。
4、音乐推荐功能
根据用户的播放历史（记录用户播放过的音乐），在页面侧边栏推荐与用户播放历史风格相似的音乐（可简单通过音乐文件名或标签中的关键词匹配来实现初步推荐）。推荐音乐列表展示音乐名称、封面图片和简短的推荐理由（例如“根据您之前播放《我爱你中国》推荐，风格相似”）。
5、界面设计与交互
设计一个美观、简洁且易用的用户界面。音乐列表和播放列表的展示应清晰明了，各个功能按钮的布局应合理，方便用户操作。
当用户进行各种操作（如播放、暂停、切换音乐、搜索等）时，提供适当的反馈信息，例如播放按钮在播放时切换为暂停图标并变色，搜索时显示搜索提示或进度等。
6、数据存储
使用浏览器的本地存储（localStorage或sessionStorage）来存储用户的播放历史、自定义播放列表等数据，以便用户下次打开页面时能够恢复之前的状态。
二、技术要求
1、必须使用JavaScript和jQuery来实现上述功能，合理运用jQuery的事件处理、DOM操作、动画效果等特性。
2、对于音乐播放功能，可使用HTML5的音频API（Audio对象）来实现音频的播放、暂停、进度控制等操作。
3、数据的读取、存储和处理应遵循良好的编程规范，确保代码的可读性和可维护性。
4、代码应具备一定的兼容性，能够在主流现代浏览器（如Chrome、Firefox、Edge等）上正常运行。 -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>

<style>
    /* 底部栏覆盖左侧栏覆盖顶部栏，剩余为主题部分，除主体部分可滑动外，其余部分均固定在顶部左边和底部 */
    .top-bar {
        position: fixed;
        top: 0;
        left: 0;                                 /* 左侧栏 */
        width: 100%;
        height: 40px;
        background-color: #333;
        color: #fff;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
    }

   .search-box {
        display: flex;
        align-items: center;
    }

   .search-box input {
        width: 200px;
        height: 30px;
        padding: 0 10px;
        border: none;
        border-radius: 3px;
        background-color: #fff;
    }

   .search-box button {
        width: 60px;
        height: 30px;
        border: none;
        border-radius: 3px;
        background-color: #4CAF50;
        color: #fff;
        cursor: pointer;
    }

   .account {
        display: flex;
        align-items: center;
    }

   .account img {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        margin-right: 10px;
    }

   .account span {
        font-size: 16px;
    }

   .main-content {
        display: flex;
        height: 100vh;
    }

   .left-sidebar {
        width: 200px;
        height: 100%;
        background-color: #f5f5f5;
        position: fixed;
        top: 40px;
        left: 0;
        overflow-y: auto;
    }

   .music_added {
        padding: 10px;
        font-size: 16px;
        color: #333;
        background-color: #f5f5f5;
        border-bottom: 1px solid #ccc;
    }

   .custom-list {
        padding: 10px;
    }

   .custom-list h3 {
        font-size: 16px;
        color: #333;
        margin-bottom: 10px;
    }

   .custom-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

   .custom-list li {
        padding: 10px;
        border-bottom: 1px solid #ccc;
        cursor: pointer;
    }

   .custom-list li:hover {
        background-color: #f5f5f5;
    }

   .custom-list li span {
        font-size: 14px;
        color: #666;
    }

   .recommend-list {
        padding: 10px;
    }

   .recommend-list h3 {
        font-size: 16px;
        color: #333;
        margin-bottom: 10px;
    }

   .recommend-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

   .recommend-list li {
        padding: 10px;
        border-bottom: 1px solid #ccc;
        cursor: pointer;
    }

   .recommend-list li:hover {
        background-color: #f5f5f5;
    }

   .recommend-list li span {
        font-size: 14px;
        color: #666;
    }

   .right-main {
        width: calc(100% - 200px);
        height: 100%;
        position: fixed;
        top: 40px;
        right: 0;
        overflow-y: auto;
    }

   .music-list {
        padding: 10px;
    }

   .music-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

   .music-list li {
        display: flex;
        align-items: center;
        padding: 10px;
        border-bottom: 1px solid #ccc;
        cursor: pointer;
    }

   .music-list li:hover {
        background-color: #f5f5f5;
    }

   .music-list li img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        margin-right: 10px;
    }

   .music-list li span {
        font-size: 14px;
        color: #333;
    }

   .bottom-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 40px;
        background-color: #333;
        color: #fff;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
    }

   .play-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #4CAF50;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
    }

   .play-btn i {
        font-size: 20px;
    }

   .progress-bar {
        width: 70%;
        height: 10px;
        background-color: #ccc;
        position: relative;
    }

   .progress {
        height: 100%;
        background-color: #4CAF50;
        position: absolute;
        left: 0;
        top: 0;
    }

   .volume-bar {
        display: flex;
        align-items: center;
    }

   .volume-bar i {
        font-size: 20px;
        margin-right: 10px;
    }

    /* 响应式布局 */
    /* @media screen and (max-width: 768px) {
       .top-bar {
            height: 50px;
            padding: 0 10px;
        }

       .search-box input {
            width: 150px;
        }

       .account img {
            width: 25px;
            height: 25px;
        }

       .account span {
            font-size: 14px;
        }

       .left-sidebar {
            width: 150px;
        }

        .custom-list h3 {
            font-size: 14px;
        }

       .custom-list li {
            padding: 5px;
        }

       .custom-list li span {
            font-size: 12px;
        }

        .recommend-list h3 {
            font-size: 14px;
        }

       .recommend-list li {
            padding: 5px;
        }

        .recommend-list li span {
            font-size: 12px;
        }

       .right-main {
            width: calc(100% - 150px);
        }

       .music-list li {
            padding: 5px;
        }

       .music-list li img {
            width: 40px;
            height: 40px;
        }

       .music-list li span {
            font-size: 12px;
        }

       .bottom-bar {
            height: 50px;
            padding: 0 10px;
        }

       .play-btn {
            width: 30px;
            height: 30px;
        }

       .play-btn i {
            font-size: 16px;
        }

       .progress-bar {
            width: 60%;
        }

       .volume-bar i {
            font-size: 16px;
        }
    } */
    
</style>

<script>
    //音乐列表
    var musicList = [];

    //自定义歌单列表
    var customList = [];

    //推荐歌单列表
    var recommendList = [];

    //当前播放的音乐
    var currentMusic = null;

    //当前播放的音乐的进度
    var currentProgress = 0;

    //当前播放的音乐的总时长
    var currentDuration = 0;

    //当前音量
    var currentVolume = 1;

    //是否静音
    var isMute = false;

    //加载音乐列表
    function loadMusicList() {
        //获取music文件夹下所有音乐文件
        var musicFiles = [];
        $.ajax({
            url: 'music',
            type: 'GET',
            async: false,
            success: function(data) {
                musicFiles = data;
            }
        });

        //遍历音乐文件，获取音乐名称和封面图片
        for (var i = 0; i < musicFiles.length; i++) {
            var music = {};
            music.name = musicFiles[i].replace('.mp3', '');
            music.cover = 'images/' + music.name + '.jpg';
            musicList.push(music);
        }

        //渲染音乐列表
        var html = '';
        for (var i = 0; i < musicList.length; i++) {
            var music = musicList[i];
            html += '<li data-music="' + i + '"><img src="' + music.cover + '"><span>' + music.name + '</span></li>';
        }
        $('.music-list ul').html(html);
    }

    //加载自定义歌单列表
    function loadCustomList() {
        //获取localStorage中的自定义歌单列表
        var customListStr = localStorage.getItem('customList');
        if (customListStr) {
            customList = JSON.parse(customListStr);
        }

        //渲染自定义歌单列表
        var html = '';
        for (var i = 0; i < customList.length; i++) {
            var list = customList[i];
            html += '<li data-list="' + list.name + '"><span>' + list.name + '</span><i class="fa fa-trash"></i></li>';
        }
        $('.custom-list ul').html(html);
    }

    //加载推荐歌单列表



    $(document).ready(function() {
        //加载音乐列表
        loadMusicList();

        //加载自定义歌单列表
        loadCustomList();

        //加载推荐歌单列表
        loadRecommendList();
        
        //搜索音乐
        $('.search-btn').click(function() {
            var keyword = $('.search-box input').val();
            if (keyword) {
                searchMusic(keyword);
            }
        });

        //播放音乐
        $('.music-list li').click(function() {
            var music = $(this).data('music');
            playMusic(music);
        });

        //暂停音乐
        $('.play-btn').click(function() {
            if ($(this).hasClass('fa-play')) {
                $(this).removeClass('fa-play').addClass('fa-pause');
                pauseMusic();
            } else {
                $(this).removeClass('fa-pause').addClass('fa-play');
                playMusic();
            }
        });

        //上一首音乐
        $('.prev-btn').click(function() {
            prevMusic();
        });

        //下一首音乐
        $('.next-btn').click(function() {
            nextMusic();
        });

        //静音
        $('.volume-bar i:eq(2)').click(function() {
            muteMusic();
        });

        //音量调节
        $('.volume-bar i:eq(0)').click(function() {
            volumeUp();
        });

        //音量调节
        $('.volume-bar i:eq(1)').click(function() {
            volumeDown();
        });

        //添加到自定义歌单
        $('.add-list-btn').click(function() {
            var listName = prompt('请输入歌单名称：');
            if (listName) {
                addMusicToCustomList(listName);
            }
        });

        //删除自定义歌单
        $('.custom-list li').click(function() {
            var listName = $(this).data('list');
            deleteCustomList(listName);
        });

        //调整播放顺序
        $('.custom-list ul').sortable();

        //调整播放顺序
        $('.recommend-list ul').sortable();

    });
</script>

<body>
    <!-- 用网易云音乐的界面设计 -->
    <div class="top-bar">
        <div class="search-box">
            <input type="text" placeholder="搜索音乐">
            <button class="search-btn">搜索</button>
        </div>
        <div class="account">
            <img src="images/avatar.jpg" alt="avatar">
            <span>用户名</span>
        </div>
    </div>

    <div class="main-content">
        <div class="left-sidebar">
            <div>
                <h3 class="music_added">歌单一：已添加音乐</h3>
            </div>
            <div class="custom-list">
                <h3>自定义歌单列表</h3>
                <button class="add-list-btn">新建歌单</button>
                <ul></ul>
            </div>
            <div class="recommend-list">
                <h3>推荐歌单</h3>
                <ul></ul>
            </div>
        </div>
        <!-- 右侧主体：音乐播放列表 -->
        <div class="right-main">
            <div class="music-list">
                <ul></ul>
            </div>
        </div>
    </div>
    <!-- 底部栏：播放控制按钮、音乐进度条、音量调节 -->
    <div class="bottom-bar">
        <div class="play-btn">
            <i class="fa fa-play"></i>
        </div>
        <div class="progress-bar">
            <div class="progress"></div>
        </div>
        <div class="volume-bar">
            <i class="fa fa-volume-up"></i>
            <i class="fa fa-volume-down"></i>
            <i class="fa fa-volume-off"></i>
        </div>
    </div>


</body>

</html>